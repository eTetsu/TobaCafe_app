# TobaCafe_app

## サービス概要
「コスパ良し、長居良し、喫煙良しのカフェ」に特化した検索アプリです。
コーヒー1杯が安価で席数が多く、必ず喫煙スペースがあるカフェだけを厳選して掲載します。
作業や読書で長時間滞在したい喫煙者が、大手グルメサイトでは探しにくい「コスパ良く長居できる喫煙カフェ」を簡単に見つけられます。


## このサービスへの思い・作りたい理由
自宅で作業しようとしても、ついスマホを見てしまったり、ベッドに寝転がってしまったり…気づけば全然集中できていない。
かといって図書館は静かすぎて逆に落ち着かないし、おしゃれなカフェは長居しづらい雰囲気がある。
「適度に人の目があって、程よい雑音があって、コーヒー1杯でまとまった作業できて、しかもタバコが吸える場所」を探すのは本当に大変だった。
大手グルメサイトでは「喫煙可」「カフェ」で検索すると多くの選択肢がヒットしてしまい、検索した上で「気軽に長居できる喫煙カフェ」をさらに選別する手間がかる。
「今日、作業する場所をさっさと見つけたい」という非常に私的なニーズがきっかけで、「集中できる作業場所」を探す喫煙者のためのコスパ良く長居できる喫煙カフェだけを集めたアプリの作成を考えるに至った...。


## ユーザー層について
ターゲットのユーザー層
喫煙者で、カフェで作業や読書をしたい20〜30代の若い社会人・学生・フリーランス

具体的には以下のような方々を想定しています
- 予算を抑えたい喫煙者: コーヒー1杯でまとまった時間の滞在がしやすい、コスパの良い場所を求めている方
  - リモートワーカー・フリーランス: 自宅では集中できず、適度な人の目がある環境で作業したい方
  - 資格勉強中の社会人・学生: 図書館は静かすぎて落ち着かず、程よい雑音がある環境を求めている方
  - 読書好きの方: 長時間ゆっくり本を読める場所を探している方
  - 新たな作業場所を駅近で求めている方: 作業場所の慣れは自宅と変わらないため、作業場所の選択肢を多く持ちたい、あるいは新たな作業場所を開拓したい方

以上のニーズを持つユーザーに対して、作業できるカフェを迅速に提案することをコンセプトととしています。
またターゲット層のニーズを満たすため、想定滞在時間が90分以上確保しやすく、かつ気軽に訪問しやすい駅近のカフェを中心に掲載します。


## サービスの利用イメージ
【利用シーン】
- 作業前の店舗探し: 今日はどこで作業しようかと考えたとき、いつもの場所とは違う隣町等における駅近の「コスパ良く長居できる喫煙カフェ」を検索
- 条件での絞り込み: エリアで絞り込み
- 店舗詳細の確認: 営業時間、混雑状況、ユーザーレビュー（作業環境の快適さ、実際の滞在時間など）をチェック
- いいね登録: 気に入った店舗を保存し、次回以降すぐにアクセス
- 作業場所の慣れ防止: いつもの作業場所で集中できなった場合に、新たな作業場所を提案し、作業場所の慣れを防止

【得られる価値】
- 時間の節約: 大手グルメサイトで「安い」「長居できる」「喫煙可」の3条件を満たす店を探す手間が省ける
- 集中できる環境の確保: 自分の作業スタイルに合った「適度な雑音と人の目がある環境」を確実に見つけられる
- コストパフォーマンス: コーヒー1杯で長時間滞在できる店だけが掲載されているため、経済的負担が少ない
- 安心感: 必ず喫煙スペースがある店だけなので、「行ってみたら喫煙できなかった」という失敗がない


## ユーザーの獲得について
MVPリリース後のカフェデータの収集について、基本的に自分自身と手伝ってくれる友人によって掲載するカフェデータを収集します。
また、カフェデータはニッチなニーズを満たすものなので、一駅あたり１軒程度でも十分だと考えています。
掲載数は多い方が好ましいですが、多すぎても選択肢の選別に煩わしさを感じさせてしまうため、駅の規模によっても異なりますが一駅あたり１~4軒程度を最終的な目標とします。
本リリース後のユーザー投稿機能で充実させることを検討の展望として、レビュー投稿時に「Xでシェア」ボタンを設置し、ユーザーが実際に利用した喫煙できるカフェの情報を簡単にSNSで拡散できる仕組みを作ります。
シェアされた投稿には店舗情報とアプリへのリンクが自動で含まれるため、フォロワーが同じニーズを持っていればとアプリへの流入が狙えます。
さらに'「#喫煙カフェ」「#作業カフェ」'などのハッシュタグを活用し、リモートワーカーや喫煙者コミュニティへリーチを広げます。


## サービスの差別化ポイント・推しポイント
既存のグルメサイトでは「安い価格帯」「多い席数」「喫煙可否」の3条件を同時に満たす店舗を探すのにある程度の手間がかかります。
しかし、本アプリは上記の条件を満たすカフェを中心に掲載することにより検索の手間を大幅に削減し、ユーザーへ迅速に条件に合うカフェを提案します。
特に「コスパ良く、長居できる、喫煙カフェ」というニッチなニーズを持つユーザーに焦点を当てていることから、狭い検索結果故の目的地を選別する手間が省ける点が優れています。
加えて、駅近のカフェを中心的に掲載することにより、ユーザーが気軽に新たな作業場所を開拓できるようになります。
総じて、コスパ重視の若年層喫煙者という明確なターゲット設定により、ニッチながら強いニーズを持つユーザー層に刺さるサービスを提供できます。


## 機能候補
以下の()で囲まれた項目は本リリースまでに実装したいこと。

- ユーザー登録・ログイン機能
  - メールアドレス・パスワードでのユーザー登録
  - ログイン・ログアウト機能
  - プロフィール表示: ニックネーム程度
  - (- パスワードリセット機能)

- カフェ検索・一覧表示機能
  - 絞り込み検索: エリア（市区町村・駅名など）
  - 検索結果一覧の表示: 店舗名・住所・最寄り駅・コーヒー価格・席数・喫煙環境
  - (- 地図表示: Google Maps API連携)

- カフェ詳細表示機能
  - 店舗の基本情報表示
  - 店舗名・住所・最寄り駅・営業時間
  - コーヒー価格・席数・喫煙環境: 分煙/全面喫煙可
  - (- Wi-Fi有無・電源有無)
  - ユーザーレビューの表示

- カフェ登録機能（ユーザー投稿）
  - ログインユーザーによるカフェ情報の新規登録
  - 登録項目：
    - 店舗名・住所・最寄り駅・営業時間
    - コーヒー価格・席数・喫煙環境
    - (- Wi-Fi有無・電源有無)
  - 登録したカフェの編集・削除（投稿者本人のみ）

- レビュー投稿機能
  - 実際に利用したカフェへのレビュー投稿
  - 評価項目: 作業のしやすさ（5段階評価）
  - コメント欄（自由記述）

- (- いいね機能
  - カフェをいいね登録
  - いいね一覧の表示)

- (- 行ってみたい機能 
  - カフェを行ってみたい登録
  - 行ってみたいカフェの一覧表示)

- (- 管理者機能
  - カフェ情報の新規登録・編集・削除)

- (- SNSシェア機能
  - レビュー投稿後にX（旧Twitter）でシェアできるボタン
  - シェア時のテンプレート文言・ハッシュタグ自動挿入)

必要最小限のMVPリリースとして、まずは()内を除いた機能を実装しようと考えています。


## 使用する技術スタック
使用予定Gemの()内で囲まれた機能部分は本リリースに合わせて実装予定。

1. 開発環境: Docker
2. フレームワーク
  Ruby on Rails 7.0系（最新の安定版を使用）
  Ruby 3.2系を使用
  Hotwire（Turbo・Stimulus）を活用し、ページ遷移を高速化
  基本的なCRUD操作はRailsの規約に沿って実装
3. データベース
  PostgreSQL: Renderでの運用実績が豊富で、本番環境との互換性が高い
4. デプロイ先
  Render: 無料枠でPostgreSQLが使用でき、Herokuの代替として安定性が高い。また、自動デプロイ設定が簡単
5. 使用予定のGem（ライブラリ）
  認証・ユーザー管理機能
    - Sorcery（ユーザー登録・ログイン機能）
      メールアドレス・パスワードでの認証
      シンプルで学習コストが低く、必要十分な認証機能を提供
  ページネーション機能
    - kaminari（一覧表示のページ分割）
      カフェ一覧・レビュー一覧で使用
  検索機能
    - Ransack（詳細な絞り込み検索）
      エリア・価格帯・分煙などでの絞り込み
      並び替え機能も簡単に実装可能
  コード品質管理機能
    - RuboCop（コードの静的解析、Lintチェック）
      コードスタイルを統一
      バグの早期発見
  (画像アップロード機能
    - ActiveStorage（Railsの標準機能）
      カフェの写真やユーザーアイコンのアップロード)
  (地図表示機能
    - Google Maps API（JavaScript）
      カフェの位置情報を地図上に表示
      検索結果を地図上にピン表示)
  (住所・位置情報の取得機能
    - Geocoder（住所から緯度経度を取得）
      カフェの住所を登録時に自動で緯度経度に変換
      地図表示や距離計算に使用)
  (環境変数管理機能
    - dotenv-rails（開発環境での環境変数管理）
      Google Maps APIキーなどの秘密情報を安全に管理)


## 機能の実装優先度
  ### MVP（最優先）
  - ユーザー登録・ログイン機能
  - カフェ一覧・検索機能
  - カフェ詳細表示機能
  - カフェ登録機能（ユーザー投稿）
  - レビュー投稿機能

  ### 本リリース
  - いいね機能
  - 行ってみたい機能
  - 地図表示機能
  - 管理者機能

  ### 将来的な拡張
  - SNS連携機能


## 主要なテーブル設計
1. usersテーブル
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | bigint | PK | |
| email | string | NOT NULL, UNIQUE | ログイン用 |
| password_digest | string | NOT NULL | 暗号化パスワード |
| nickname | string | NOT NULL | プロフィール表示用 |
| created_at | datetime | | |
| updated_at | datetime | | |

インデックス: email

2. boardsテーブル
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | bigint | PK | |
| user_id | bigint | FK, NOT NULL | 登録者 |
| name | string | NOT NULL | 店舗名 |
| address | string | NOT NULL | 住所 |
| nearest_station | string | | 最寄り駅 |
| opening_hours | text | | 営業時間 |
| coffee_price | integer | | コーヒー価格（円） |
| seat_count | integer | | 席数 |
| smoking_policy | integer | NOT NULL | 0:喫煙スペース, 1:分煙テーブル（enum） |
| created_at | datetime | | |
| updated_at | datetime | | |

インデックス: user_id, nearest_station

3. reviewsテーブル
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | bigint | PK | |
| user_id | bigint | FK, NOT NULL | レビュー投稿者 |
| board_id | bigint | FK, NOT NULL | 対象カフェ |
| workability_rating | integer | NOT NULL | 作業しやすさ（1-5） |
| comment | text | | コメント |
| created_at | datetime | | |
| updated_at | datetime | | |

インデックス: user_id, cafe_id
複合ユニークインデックス: [user_id, cafe_id]（1ユーザー1カフェ1レビューの場合）

----- 本リリース時に実装 -----

4. likesテーブル（中間テーブル）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | bigint | PK | |
| user_id | bigint | FK, NOT NULL | いいねしたユーザー |
| board_id | bigint | FK, NOT NULL | いいねされたカフェ |
| created_at | datetime | | |
| updated_at | datetime | | |

複合ユニークインデックス: [user_id, cafe_id]（重複いいね防止）
インデックス: cafe_id

5. bookmarksテーブル（中間テーブル）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | bigint | PK | |
| user_id | bigint | FK, NOT NULL | 登録したユーザー |
| board_id | bigint | FK, NOT NULL | 行きたいカフェ |
| created_at | datetime | | |
| updated_at | datetime | | |

複合ユニークインデックス: [user_id, cafe_id]（重複登録防止）
インデックス: cafe_id

boardsテーブルに以下のカラムを追加:
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| has_wifi | boolean | default: false | Wi-Fi有無 |
| has_power_outlet | boolean | default: false | 電源有無 |

usersテーブルに以下のカラムを追加:
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| role | integer | NOT NULL, default: 0 | 0:一般ユーザー, 1:管理者（enum） |

## 画面遷移図
Figma TobaCafe_project
https://www.figma.com/design/EDZEe1kAcfDyxpWLzk9tTf/TobaCafe_project?node-id=0-1&t=mfAJ3zthFUNEdLT0-1


## ER図
[![TobaCafe_project](https://i.gyazo.com/def33e0d5b35e711b5ac694db644adce.png)](https://gyazo.com/def33e0d5b35e711b5ac694db644adce)

## 開発スケジュール
- 12月29日〜1月31日: 環境構築・基本設計
- 1月1日〜1月10日: MVPの実装（機能1〜4）
- 1月11日〜1月17日: テスト・デプロイ
- 1月18日: MVPリリース


## 非機能要件
- レスポンス時間: 平均2秒以内
- セキュリティ: パスワードのハッシュ化、HTTPS通信
- 対応ブラウザ: Chrome、Safari、Firefox最新版


## 今後の拡張予定（MVP後）
- いいね機能
- 行ってみたい機能
- 地図表示機能
- 管理者機能
- SNS連携（Xでのシェア機能）
